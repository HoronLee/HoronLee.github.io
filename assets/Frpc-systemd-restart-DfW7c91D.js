import{_ as h}from"./ValaxyMain.vue_vue_type_style_index_0_lang-BlZE3LhB.js";import{_ as p,a as d,p as c,o as k,c as m,w as i,f as s,g as t,h as f,s as g,r as e,i as u}from"./app-DYGYtZ5U.js";import"./YunFooter.vue_vue_type_script_setup_true_lang-B9Dth9xg.js";import"./YunCard.vue_vue_type_script_setup_true_lang-ZIvkhB7t.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang-nY4cFgbl.js";import"./index-C7yU5XnD.js";const n=JSON.parse('{"title":"为Systemd服务设置自动重启","description":"","frontmatter":{"layout":"post","title":"为Systemd服务设置自动重启","date":"2024-01-21T18:08:10.000Z","tags":["Linux"],"categories":["Linux"],"cover":null,"hide":null,"password":null},"headers":[{"level":2,"title":"事情起因","slug":"事情起因","link":"#事情起因","children":[]}],"relativePath":"pages/posts/Frpc-systemd-restart.md","path":"/home/runner/work/horonlee.github.io/horonlee.github.io/pages/posts/Frpc-systemd-restart.md","lastUpdated":1711418005000}'),y={name:"pages/posts/Frpc-systemd-restart.md",data(){return{data:n,frontmatter:n.frontmatter,$frontmatter:n.frontmatter}},setup(){const a=d();a.meta.frontmatter=Object.assign(a.meta.frontmatter||{},n.frontmatter||{}),c("pageData",n)}},E={id:"事情起因",tabindex:"-1"},_=s("p",null,"最近给自己的双路E5搞一个Frpc，但是因为有Clash这个开机自启程序，并且我设置了系统代理，在Clash完全启动之前系统是处于断网状态的。断网状态下，Frpc会默认启动失败并且变为Inactive状态，这并不是我想看到的。",-1),F=s("p",null,"于是我上网查询了一下，于是乎找到了以下三个Systemd-[Service]参数",-1),v=s("div",{class:"language-ini"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"ini"),s("pre",{class:"shiki shiki-themes github-light github-dark has-diff vp-code"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"[Unit]")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Description"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"=frpc service")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"After"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"=network.target syslog.target")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Wants"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"=network.target")]),t(`
`),s("span",{class:"line"}),t(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"[Service]")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Type"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"=simple")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"ExecStart"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"=/Apps/frp_0.52.3_linux_amd64/frpc -c /Apps/frp_0.52.3_linux_amd64/frpc.toml")]),t(`
`),s("span",{class:"line diff add"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Restart"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"=always")]),t(`
`),s("span",{class:"line diff add"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"RestartSec"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"=5")]),t(`
`),s("span",{class:"line diff add"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"StartLimitInterval"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"=0")]),t(`
`),s("span",{class:"line"}),t(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"[Install]")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"WantedBy"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"=multi-user.target")])])]),s("button",{class:"collapse"})],-1),$=s("p",null,"三个参数的作用分别是：",-1),A=s("ol",null,[s("li",null,[s("strong",null,"Restart=always："),t(" 指定服务在退出时总是重新启动。")]),s("li",null,[s("strong",null,"RestartSec=5："),t(" 如果服务启动失败，指定在尝试重新启动之前等待的时间间隔，这里是 5 秒。")]),s("li",null,[s("strong",null,"StartLimitInterval=0："),t(" 指定尝试启动服务的最小时间间隔。在这里设置为 0 表示没有最小间隔，可以立即尝试重新启动服务。")])],-1),S=s("p",null,[t("随后只要执行"),s("code",null,"systemctl daemon-reload"),t("就可以放心重启机器，让Frpc自由启动了！")],-1);function b(a,D,C,w,l,B){const r=u,o=h;return k(),m(o,{frontmatter:l.frontmatter,data:l.data},{"main-content-md":i(()=>[s("h2",E,[t("事情起因 "),f(r,{class:"header-anchor",href:"#事情起因","aria-label":'Permalink to "事情起因"'},{default:i(()=>[t("​")]),_:1})]),_,g(" more "),F,v,$,A,S]),"main-header":i(()=>[e(a.$slots,"main-header")]),"main-header-after":i(()=>[e(a.$slots,"main-header-after")]),"main-nav":i(()=>[e(a.$slots,"main-nav")]),"main-content":i(()=>[e(a.$slots,"main-content")]),"main-content-after":i(()=>[e(a.$slots,"main-content-after")]),"main-nav-before":i(()=>[e(a.$slots,"main-nav-before")]),"main-nav-after":i(()=>[e(a.$slots,"main-nav-after")]),comment:i(()=>[e(a.$slots,"comment")]),footer:i(()=>[e(a.$slots,"footer")]),aside:i(()=>[e(a.$slots,"aside")]),"aside-custom":i(()=>[e(a.$slots,"aside-custom")]),default:i(()=>[e(a.$slots,"default")]),_:3},8,["frontmatter","data"])}const O=p(y,[["render",b]]);export{n as data,O as default};
