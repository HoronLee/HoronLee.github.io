import{_ as F}from"./ValaxyMain.vue_vue_type_style_index_0_lang-BlZE3LhB.js";import{_ as p,a as d,p as o,o as g,c,w as l,f as s,g as i,h as n,r as t,i as y}from"./app-DYGYtZ5U.js";import"./YunFooter.vue_vue_type_script_setup_true_lang-B9Dth9xg.js";import"./YunCard.vue_vue_type_script_setup_true_lang-ZIvkhB7t.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang-nY4cFgbl.js";import"./index-C7yU5XnD.js";const e=JSON.parse('{"title":"初试Kubernetes笔记","description":"","frontmatter":{"title":"初试Kubernetes笔记","date":"2023-04-04T13:27:28.000Z","tags":["Linux","Kubernetes","云计算"],"categories":["服务器运维","云计算","k8s"],"cover":"https://d33wubrfki0l68.cloudfront.net/2475489eaf20163ec0f54ddc1d92aa8d4c87c96b/e7c81/images/docs/components-of-kubernetes.svg"},"headers":[],"relativePath":"pages/posts/Kubernetes-note.md","path":"/home/runner/work/horonlee.github.io/horonlee.github.io/pages/posts/Kubernetes-note.md","lastUpdated":1711418005000}'),E={name:"pages/posts/Kubernetes-note.md",data(){return{data:e,frontmatter:e.frontmatter,$frontmatter:e.frontmatter}},setup(){const a=d();a.meta.frontmatter=Object.assign(a.meta.frontmatter||{},e.frontmatter||{}),o("pageData",e)}},u={id:"关于k8s镜像的下载",tabindex:"-1"},C=s("blockquote",null,[s("p",null,"说实话我真的吐了，没有科学上网真的寸步难行，没办法直接拉取k8s.gcr.io的镜像，所以只能先用阿里云的 但是后续的安装没办法直接使用阿里云的镜像，所以还得改tag")],-1),B=s("p",null,[i("有个小坑，k8s官方镜像的coredns是"),s("code",null,"k8s.gcr.io/coredns/coredns:v1.8.6"),i("而阿里的却是"),s("code",null,"registry.aliyuncs.com/google_containers/coredns:v1.8.6"),i("，官方的多套了一层"),s("code",null,"/coredns"),i("，这直接导致我研究了半天"),s("code",null,"报错 pull access denied"),i("，我发现后就把阿里的镜像给删掉了一层。")],-1),m=s("p",null,"因为总共要下载7个镜像（master节点），所以我打算写一个shell脚本来批量操作，经过一番高强度网上冲浪，我给整出来了：",-1),b=s("div",{class:"language-shell"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"shell"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," #!/bin/bash")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"images_list"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"k8s.gcr.io/kube-apiserver:v1.24.0")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"k8s.gcr.io/kube-controller-manager:v1.24.0")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"k8s.gcr.io/kube-scheduler:v1.24.0")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"k8s.gcr.io/kube-proxy:v1.24.0")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"k8s.gcr.io/pause:3.7")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"k8s.gcr.io/etcd:3.5.3-0")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"k8s.gcr.io/coredns/coredns:v1.8.6")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"ali_images_list"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"registry.aliyuncs.com/google_containers/kube-apiserver:v1.24.0")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"registry.aliyuncs.com/google_containers/kube-controller-manager:v1.24.0")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"registry.aliyuncs.com/google_containers/kube-scheduler:v1.24.0")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"registry.aliyuncs.com/google_containers/kube-proxy:v1.24.0")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"registry.aliyuncs.com/google_containers/pause:3.7")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"registry.aliyuncs.com/google_containers/etcd:3.5.3-0")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"registry.aliyuncs.com/google_containers/coredns:v1.8.6")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 批量下载阿里镜像并且更改tag为k8s标准镜像")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"for"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," i "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"in"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," $ali_images_list")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"do")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        docker"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," pull"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," $i")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        for"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," j "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"in"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," $images_list")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        do")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"                docker"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," tag"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," $i $j")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        done")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"done")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 删除阿里镜像")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"for"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," i "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"in"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," $ali_images_list")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"do")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        docker"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," image"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," rm"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," $i")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"done")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 导出k8s镜像为tar包")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"docker"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," save"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -o"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," k8s-1-24-0.tar"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," $images_list")])])]),s("button",{class:"collapse"})],-1),f=s("p",null,"第一次写脚本这样应该很不错了吧（汗",-1),v={id:"关于kubeadm-init的报错",tabindex:"-1"},_=s("blockquote",null,[s("p",null,[i("先前安装的kubeadm等组件使用了"),s("code",null,"yum -y install kubeadm kubelet kubectl"),i("，默认版本比较高 所以引发了下面一系列错误")])],-1),A=s("div",{class:"language-bash"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"bash"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[root@k8s-master01 "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"~"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"]# kubeadm init --kubernetes-version=v1.24.0 --pod-network-cidr=10.224.0.0/16 --apiserver-advertise-address=192.168.100.100  --cri-socket unix:///var/run/cri-dockerd.sock")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"this"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," version"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," of"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," kubeadm"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," only"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," supports"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," deploying"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," clusters"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," with"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," the"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," control"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," plane"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," version"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," >"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"="),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 1.25"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},".0."),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," Current"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," version:"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," v1.24.0")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"To"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," see"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," the"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," stack"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," trace"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," of"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," this"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," error"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," execute"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," with"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --v=5"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," or"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," higher")])])]),s("button",{class:"collapse"})],-1),D=s("p",null,"需要版本高于v1.25.0的control plane，但是我升级了组件镜像为v1.25.0也同样报错！ 所以我采用指定yum安装kubeadm、kubelet和kubectl：",-1),$=s("div",{class:"language-bash"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"bash"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[root@k8s-master01 "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"~"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"]# yum -y remove  kubeadm  kubelet kubectl")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[root@k8s-master01 "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"~"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"]# yum install -y kubelet-1.25.0 kubeadm-1.25.0 kubectl-1.25.0")])])]),s("button",{class:"collapse"})],-1),w=s("p",null,"不出意外又是报错",-1),T=s("div",{class:"language-"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"}),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",null,[s("span",{class:"line"},[s("span",null,"[preflight] Running pre-flight checks")]),i(`
`),s("span",{class:"line"},[s("span",null,"error execution phase preflight: [preflight] Some fatal errors occurred:")]),i(`
`),s("span",{class:"line"},[s("span",null,'        [ERROR KubeletVersion]: the kubelet version is higher than the control plane version. This is not a supported version skew and may lead to a malfunctional cluster. Kubelet version: "1.25.0" Control plane version: "1.24.0"')]),i(`
`),s("span",{class:"line"},[s("span",null,"[preflight] If you know what you are doing, you can make a check non-fatal with `--ignore-preflight-errors=...`")]),i(`
`),s("span",{class:"line"},[s("span",null,"To see the stack trace of this error execute with --v=5 or higher")])])]),s("button",{class:"collapse"})],-1),K=s("p",null,"意思是kubeadm还是高于panel组件的版本，这里我尝试降级kubeadm、kubelet和kubectl：",-1),x=s("div",{class:"language-bash"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"bash"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[root@k8s-master01 "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"~"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"]# yum remove -y kubelet-1.25.0 kubeadm-1.25.0 kubectl-1.25.0")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[root@k8s-master01 "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"~"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"]# yum install -y kubelet-1.24.0 kubeadm-1.24.0 kubectl-1.24.0")])])]),s("button",{class:"collapse"})],-1),R=s("p",null,"更换kubeadm、kubelet、kubectl版本为v1.24.0之后：",-1),N=s("div",{class:"language-bash"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"bash"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[init] Using Kubernetes version: v1.24.0")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[preflight] Running pre-flight checks")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[preflight] Pulling images required "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"for"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," setting up a Kubernetes cluster")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[preflight] This might take a minute or two, depending on the speed of your internet connection")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[preflight] You can also perform this action "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"in"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," beforehand using "),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'kubeadm config images pull'")])])]),s("button",{class:"collapse"})],-1),I=s("p",null,"这里问题不大，我一开始拉了一点v1.25.0的镜像，我给全部换成v1.24.0就好了 PS：记得再次修改配置：",-1),P=s("div",{class:"language-vim"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"vim"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"#"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," vim "),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#DBEDFF"}},"/etc/"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"sysconfig/kubelet")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"KUBELET_EXTRA_ARGS"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"--cgroup-driver=systemd"')]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"systemctl enable kubelet")])])]),s("button",{class:"collapse"})],-1),O=s("p",null,"然后就可以正常初始化了...吗？",-1),S=s("div",{class:"language-bash"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"bash"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[wait-control-plane] Waiting "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"for"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," the kubelet to boot up the control plane as static Pods from directory "),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/etc/kubernetes/manifests"'),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},". This can take up to 4m0s")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[kubelet-check] Initial timeout of 40s passed.")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Unfortunately,"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," an"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," error"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," has"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," occurred:")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        timed"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," out"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," waiting"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," for"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," the"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," condition")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"This"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," error"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," is"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," likely"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," caused"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," by:")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        -"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," The"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," kubelet"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," is"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," not"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," running")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        -"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," The"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," kubelet"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," is"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," unhealthy"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," due"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," to"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," a"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," misconfiguration"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," of"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," the"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," node"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," in"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," some"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," way"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (required "),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"cgroups"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," disabled"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"If"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," you"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," are"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," on"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," a"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," systemd-powered"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," system,"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," you"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," can"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," try"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," to"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," troubleshoot"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," the"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," error"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," with"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," the"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," following"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," commands:")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        -"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 'systemctl status kubelet'")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        -"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 'journalctl -xeu kubelet'")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Additionally,"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," a"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," control"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," plane"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," component"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," may"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," have"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," crashed"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," or"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," exited"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," when"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," started"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," by"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," the"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," container"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," runtime.")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"To"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," troubleshoot,"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," list"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," all"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," containers"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," using"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," your"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," preferred"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," container"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," runtimes"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," CLI.")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Here"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," is"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," one"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," example"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," how"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," you"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," may"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," list"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," all"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," running"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," Kubernetes"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," containers"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," by"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," using"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," crictl:")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        -"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 'crictl --runtime-endpoint unix:///var/run/cri-dockerd.sock ps -a | grep kube | grep -v pause'")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        Once"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," you"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," have"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," found"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," the"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," failing"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," container,"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," you"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," can"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," inspect"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," its"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," logs"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," with:")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        -"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 'crictl --runtime-endpoint unix:///var/run/cri-dockerd.sock logs CONTAINERID'")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"error"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," execution"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," phase"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," wait-control-plane:"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," couldn't initialize a Kubernetes cluster")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"To see the stack trace of this error execute with --v=5 or higher")])])]),s("button",{class:"collapse"})],-1),V=s("p",null,"初始化control-plane超时了 至此，问题还没有解决。",-1);function j(a,q,L,U,h,z){const k=y,r=F;return g(),c(r,{frontmatter:h.frontmatter,data:h.data},{"main-content-md":l(()=>[s("h1",u,[i("关于k8s镜像的下载 "),n(k,{class:"header-anchor",href:"#关于k8s镜像的下载","aria-label":'Permalink to "关于k8s镜像的下载"'},{default:l(()=>[i("​")]),_:1})]),C,B,m,b,f,s("h1",v,[i("关于kubeadm init的报错 "),n(k,{class:"header-anchor",href:"#关于kubeadm-init的报错","aria-label":'Permalink to "关于kubeadm init的报错"'},{default:l(()=>[i("​")]),_:1})]),_,A,D,$,w,T,K,x,R,N,I,P,O,S,V]),"main-header":l(()=>[t(a.$slots,"main-header")]),"main-header-after":l(()=>[t(a.$slots,"main-header-after")]),"main-nav":l(()=>[t(a.$slots,"main-nav")]),"main-content":l(()=>[t(a.$slots,"main-content")]),"main-content-after":l(()=>[t(a.$slots,"main-content-after")]),"main-nav-before":l(()=>[t(a.$slots,"main-nav-before")]),"main-nav-after":l(()=>[t(a.$slots,"main-nav-after")]),comment:l(()=>[t(a.$slots,"comment")]),footer:l(()=>[t(a.$slots,"footer")]),aside:l(()=>[t(a.$slots,"aside")]),"aside-custom":l(()=>[t(a.$slots,"aside-custom")]),default:l(()=>[t(a.$slots,"default")]),_:3},8,["frontmatter","data"])}const Y=p(E,[["render",j]]);export{e as data,Y as default};
