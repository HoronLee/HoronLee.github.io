---
layout: post
title: 家庭宽带桥接并为路由器配置DDNS
date: 2024-01-30 18:23:04
tags: 
    - 网络
    - 折腾
categories: 
    - 网络工程
cover: https://cdn.cnbj0.fds.api.mi-img.com/b2c-shopapi-pms/pms_1628502573.65515782.jpg
password: 
hide: false
---

> 事情起因：寒假一人家在空虚寂寞无聊，于是乎想实现一下之前一直想做的NAS，故开始上网查询、Q群询问大佬，最终完成了一部分目标（汗）。

首先确认自己是否拥有公网IP，电信是比较容易要到的，联通和移动几率不大，如何查询自己是否有公网IP呢？可以参考这个问题的回答：[如何确定自己的IP地址是公网IP还是运营商内网IP？ - 知乎 (zhihu.com)](https://www.zhihu.com/question/288053819)

# 家庭宽带改为桥接上网

​	这一步是最基础也是家庭布网最重要的一环，众所周知，目前大部分家庭宽带的上网方式都是路由上网，也就是非光猫拨号，而是互联网供应商直接分配一个内网IP给家里的光猫，在这种情况下，全屋是不可能获得公网IP的（IPv4）。

​	所以第一要务就是打电话给运营商客服（我是电信，打给10000），但是本人社恐很深，所以直接在电信的app上面和客服沟通。⚠️注意：需要提供家庭宽带注册人的身份证号码和名字，否则客服不会改。

​	和客服说的时候可以直接一点，直截了当说请讲我家光猫改为桥接上网，一般来说客服是不会有其他疑问的，只会和你二次确认一下是否更改（我不推荐联系光猫师傅，因为他们都会避嫌麻烦事，会直接说改成桥接之后你容易弄不好网络）。

​	如果不出意外，经过约3分钟的断网后，你通过网线或者光猫WiFi连接到光猫，登录后台之后查看光猫的上网设置——Wan口IP，发下Wan口的IP居然没了。这是正常现象，因为现在家里的宽带是桥接上网，需要一个路由设备来进行拨号才能上网。也就是说在当前状况下，光猫只是具备了一个[光调制解调器](https://baike.baidu.com/item/光调制解调器/9455758)的功能，并不具备路由功能。到这儿，第一步骤就算圆满完成了。

# 连接路由器进行拨号上网

> 上一步骤说到光猫没有路由功能了，所以请在光猫下面连接一个任意品牌的路由器（OpenWrt软路由也是可以的）来进行拨号。

​	我是用的是小米的AX3000作为路由器，在接上路由器之后，查看光猫的连接设备列表，可以看到刚才接入的路由器的IP，（或者直接看连接 WiFi 设备的网关地址）从而登录路由器管理页面。之后再进入路由器的上网设置页面，选择PPPoE拨号上网，填入宽带账号密码（忘记了的话可以再问一下客服），拨号成功之后，就能在 WiFi 的设置页面看到外网 IP 了。

# 配置DDNS

> 小米路由器限定了 DDNS 的服务商，经过筛选我选择了可以免费使用的 No-ip 来配置 DDNS 服务

1. 进入 [My No-IP (noip.com)](https://noip.com/) 官网
2. 在Create Your Free Hostname Now下方的 Hostname 中输入你想要的二级域名前缀，然后直接点击 Sign Up 注册账号即可
3. 待续...

